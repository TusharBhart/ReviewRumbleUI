<table mat-table [dataSource]="pullRequests" matSort>
    <!-- Title Column -->
    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Title</th>
      <td mat-cell *matCellDef="let pullRequest">
        <a class="hyperlink-text flex-center" [href]="pullRequest.url" target="_blank">{{
          pullRequest.title
        }}</a>
      </td>
    </ng-container>
  
    <!-- Author Column -->
    <ng-container matColumnDef="author">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Author</th>
      <td mat-cell *matCellDef="let pullRequest">
        <a [href]="'https://github.com/' + pullRequest.author.username" target="_blank" class="hyperlink-text flex-center">
          <img height="24px" width="24px" [src]="'https://avatars.githubusercontent.com/u/'+ pullRequest.author.id +'?v=4&size=64'" class="avatar-image" />
          {{ pullRequest.author.username }}
        </a>
      </td>
    </ng-container>
  
    <!-- Repository Column -->
    <ng-container matColumnDef="repository">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Repository</th>
      <td mat-cell *matCellDef="let pullRequest">
        <a [href]="'https://github.com/watchguard-it/' + pullRequest.repository" target="_blank" class="hyperlink-text flex-center">
           <mat-icon style="margin-right: 8px; width: 16px;" svgIcon="github-icon"></mat-icon>
          {{ pullRequest.repository }}
        </a>
      </td>
    </ng-container>
  
    <!-- Status Column -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
      <td mat-cell *matCellDef="let pullRequest">
        @if (showActions) {
          <mat-select [(value)]="pullRequest.status" class="sm-text bold" [ngClass]="getStatusColor(pullRequest.status)" (selectionChange)="updateStatus(pullRequest, $event.value)">
            @for (status of statusOptions; track $index) {
              <mat-option [value]="status" selected><span
                class="sm-text bold"
                [ngClass]="getStatusColor(status)"
                >{{ status }}</span
              ></mat-option>
            }
          </mat-select>
        } @else {
          <span class="sm-text bold" [ngClass]="getStatusColor(pullRequest.status)">{{ pullRequest.status }}</span>
        }
      </td>
    </ng-container>
  
    <!-- Added Date Column -->
    <ng-container matColumnDef="addedDate">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Added Date</th>
      <td mat-cell *matCellDef="let pullRequest">
        {{ pullRequest.addedDate | date : "mediumDate" }}
      </td>
    </ng-container>
  
    <!-- Reviewers Column -->
    <ng-container matColumnDef="reviewers">
      <th mat-header-cell *matHeaderCellDef>
        Reviewers
      </th>
      <td mat-cell *matCellDef="let pullRequest">
        <mat-chip-set>
          @for (reviewer of pullRequest.reviewers; track $index) {
            <mat-chip>
              <img matChipAvatar [src]="'https://avatars.githubusercontent.com/u/' + reviewer.id + '?v=4&size=64'" />
              <span style="font-size: 11px;">{{ reviewer.username }}</span>
            </mat-chip>
          }
        </mat-chip-set>
      </td>
    </ng-container>
  
    <!-- Table Header and Row Definition -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns" style="font-weight: 600;"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns" class="sm-text"></tr>
  </table>